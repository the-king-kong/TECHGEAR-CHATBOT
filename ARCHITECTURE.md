# ğŸ—ï¸ TechGear Chatbot - System Architecture Diagram

## Complete Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚                           ğŸŒ USER INTERFACE                                â”‚
â”‚                  (http://localhost:8000/)                                   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Beautiful UI with soothing teal/cyan gradients                      â”‚  â”‚
â”‚  â”‚  â€¢ User input field                                                  â”‚  â”‚
â”‚  â”‚  â€¢ Real-time message display                                         â”‚  â”‚
â”‚  â”‚  â€¢ Category badges (ğŸ›ï¸ Product, â†©ï¸ Returns, ğŸ‘¨â€ğŸ’¼ Escalation)      â”‚  â”‚
â”‚  â”‚  â€¢ Loading animation                                                 â”‚  â”‚
â”‚  â”‚  â€¢ Clear chat button                                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚                                           â”‚
â”‚                    User sends query (JSON)                                  â”‚
â”‚                                 â”‚                                           â”‚
â”‚                                 â–¼                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    POST /chat endpoint
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚                         ğŸŒ FASTAPI SERVER                                  â”‚
â”‚                    (http://localhost:8000)                                  â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ChatRequest validation (Pydantic)                                  â”‚  â”‚
â”‚  â”‚  â€¢ Query field validation                                           â”‚  â”‚
â”‚  â”‚  â€¢ Error handling                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                   â”‚                                        â”‚
â”‚                                   â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Call process_query(query) from graph.py                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                   â”‚                                        â”‚
â”‚                                   â–¼                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚                      ğŸ§  LANGGRAPH WORKFLOW                                 â”‚
â”‚                  (Multi-node orchestration)                                 â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                     START STATE                                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ GraphState:                                                    â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - query: str          (user's question)                       â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - category: str       (product/returns/general)              â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - response: str       (chatbot's answer)                      â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - escalation_reason: str (reason if escalated)               â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚                                          â”‚
â”‚                                 â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         NODE 1: CLASSIFIER NODE ğŸ·ï¸                                  â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  Prompt: "Classify query as product/returns/general"               â”‚  â”‚
â”‚  â”‚  LLM: Gemini 2.0 Flash                                             â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  Input:  "What is the price of SmartWatch?"                        â”‚  â”‚
â”‚  â”‚  Output: category = "product"                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚                                          â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚                    â”‚   Conditional Router   â”‚                             â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                                 â”‚                                          â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚        â”‚                        â”‚                        â”‚                â”‚
â”‚   product?              returns?                general?  â”‚                â”‚
â”‚   returns?                                               â”‚                â”‚
â”‚        â”‚                        â”‚                        â”‚                â”‚
â”‚        â–¼                        â–¼                        â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚NODE 2: RAG      â”‚  â”‚NODE 2: RAG      â”‚  â”‚NODE 3: ESCALATION    â”‚     â”‚
â”‚  â”‚RESPONDER        â”‚  â”‚RESPONDER        â”‚  â”‚NODE                  â”‚     â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                      â”‚     â”‚
â”‚  â”‚Query: product   â”‚  â”‚Query: returns   â”‚  â”‚Returns:              â”‚     â”‚
â”‚  â”‚ or              â”‚  â”‚ or              â”‚  â”‚"Query escalated to   â”‚     â”‚
â”‚  â”‚returns query    â”‚  â”‚warranty info    â”‚  â”‚human support team.   â”‚     â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚Ticket: SUPPORT-...  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚        â”‚                        â”‚                        â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚                        â”‚
         â”‚ Example: "â‚¹15,999"     â”‚ Example: "7-day      â”‚ Example:
         â”‚ (from database)        â”‚ return policy"       â”‚ "Escalated"
         â”‚                        â”‚ (from database)      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚              ğŸ“¥ DATABASE: CHROMADB with VECTOR EMBEDDINGS                  â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  RAG RESPONDER NODE (detailed flow):                               â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚  1. Load ChromaDB:                                                 â”‚  â”‚
â”‚  â”‚     â””â”€ Located at ./chroma_db/                                    â”‚  â”‚
â”‚  â”‚     â””â”€ Contains 2 persisted chunks                                â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚  2. Create Retriever:                                              â”‚  â”‚
â”‚  â”‚     â””â”€ Vector search (similarity matching)                        â”‚  â”‚
â”‚  â”‚     â””â”€ Return top 3 most relevant chunks                          â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚  3. Retrieve Chunks:                                               â”‚  â”‚
â”‚  â”‚     Input:  "What is the price of SmartWatch?"                    â”‚  â”‚
â”‚  â”‚     Output: âœ… CHUNK 1: SmartWatch - â‚¹15,999 (match score: 0.89)  â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚  4. Build RAG Chain:                                               â”‚  â”‚
â”‚  â”‚     Prompt Template: "Answer ONLY using provided context"         â”‚  â”‚
â”‚  â”‚     Context: Retrieved chunks from database                       â”‚  â”‚
â”‚  â”‚     Query: User's question                                        â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚  5. Call Gemini LLM:                                               â”‚  â”‚
â”‚  â”‚     Model: gemini-2.0-flash                                       â”‚  â”‚
â”‚  â”‚     Input: (prompt + context + query)                             â”‚  â”‚
â”‚  â”‚     Output: âœ… "â‚¹15,999"                                           â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚  6. Return Answer:                                                 â”‚  â”‚
â”‚  â”‚     Response: "â‚¹15,999"                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  CHROMADB VECTOR DATABASE CONTENT:                                 â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚  ğŸ“¦ CHUNK 1: SmartWatch Pro X Product Info                         â”‚  â”‚
â”‚  â”‚  â”œâ”€ Price: â‚¹15,999                                                â”‚  â”‚
â”‚  â”‚  â”œâ”€ Display: AMOLED (1.4 inches)                                  â”‚  â”‚
â”‚  â”‚  â”œâ”€ Battery: 5 days                                               â”‚  â”‚
â”‚  â”‚  â”œâ”€ Sports Modes: 50+                                             â”‚  â”‚
â”‚  â”‚  â”œâ”€ Water Resistant: 5ATM                                         â”‚  â”‚
â”‚  â”‚  â””â”€ Health Monitoring: HR, SpO2                                   â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚  ğŸ“¦ CHUNK 2: Wireless Earbuds Elite + Power Bank Info             â”‚  â”‚
â”‚  â”‚  â”œâ”€ Earbuds Price: â‚¹4,999                                         â”‚  â”‚
â”‚  â”‚  â”œâ”€ Noise Cancellation: Yes (ANC)                                 â”‚  â”‚
â”‚  â”‚  â”œâ”€ Battery: 24 hours (8hr buds + 16hr case)                      â”‚  â”‚
â”‚  â”‚  â”œâ”€ Return Policy: 7-day no-questions-asked                       â”‚  â”‚
â”‚  â”‚  â”œâ”€ Refund Timeline: 5-7 business days                            â”‚  â”‚
â”‚  â”‚  â””â”€ Power Bank: 10,000mAh, 25W fast charging                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    (Response + Category)
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚              ğŸ“¤ FASTAPI RESPONSE (ChatResponse)                            â”‚
â”‚                                                                             â”‚
â”‚  {                                                                          â”‚
â”‚    "query": "What is the price of SmartWatch Pro X?",                      â”‚
â”‚    "response": "â‚¹15,999"                                                   â”‚
â”‚  }                                                                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚                         ğŸ¨ FRONTEND DISPLAY                                â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ‘¤ User: What is the price of SmartWatch Pro X?                   â”‚   â”‚
â”‚  â”‚                                                                    â”‚   â”‚
â”‚  â”‚ ğŸ¤– Bot: â‚¹15,999                                                    â”‚   â”‚
â”‚  â”‚         ğŸ›ï¸ Product                                                â”‚   â”‚
â”‚  â”‚                                                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  Category Badge shows this came from:                                      â”‚
â”‚  ğŸ›ï¸ Product = RAG responder (database-backed)                             â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”€ Query Routing Decision Tree

```
                    User Query Received
                            â”‚
                            â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ CLASSIFIER NODE             â”‚
                â”‚ Analyzes query with Gemini â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   Extract Category        â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚                     â”‚
        â–¼                     â–¼                     â–¼
    [PRODUCT]           [RETURNS]              [GENERAL]
   (keywords:          (keywords:             (everything
    price, cost,       return,                 else)
    specs,             refund,
    features)          warranty)
        â”‚                     â”‚                     â”‚
        â”‚                     â”‚                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  CONDITIONAL ROUTER       â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚                     â”‚
    product? OR           (no match)          (escalation)
    returns?
        â”‚                     â”‚                     â”‚
        â–¼                     â”‚                     â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ RAG RESPONDER â”‚           â”‚           â”‚ ESCALATION NODE  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ â€¢ Load DB     â”‚           â”‚           â”‚ Return message:  â”‚
  â”‚ â€¢ Retrieve    â”‚           â”‚           â”‚ "Query escalated â”‚
  â”‚ â€¢ Generate    â”‚           â”‚           â”‚  to human        â”‚
  â”‚ â€¢ Return      â”‚           â”‚           â”‚  support"        â”‚
  â”‚   answer      â”‚           â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚                     â”‚
           â”‚                  â”‚                     â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    Response with badge
                              â”‚
                              â–¼
                        Frontend Display
```

---

## ğŸ“Š Technologies Used

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚                    ğŸ§¬ TECHNOLOGY STACK                                     â”‚
â”‚                                                                             â”‚
â”‚  Frontend Layer:                                                            â”‚
â”‚  â”œâ”€ HTML5                          (structure)                            â”‚
â”‚  â”œâ”€ CSS3                           (soothing UI)                          â”‚
â”‚  â””â”€ Vanilla JavaScript             (interactivity)                        â”‚
â”‚                                                                             â”‚
â”‚  API Layer:                                                                 â”‚
â”‚  â”œâ”€ FastAPI                        (web framework)                        â”‚
â”‚  â”œâ”€ Uvicorn                        (ASGI server)                          â”‚
â”‚  â”œâ”€ Pydantic                       (data validation)                      â”‚
â”‚  â””â”€ CORS Middleware                (cross-origin requests)                â”‚
â”‚                                                                             â”‚
â”‚  Workflow Layer:                                                            â”‚
â”‚  â”œâ”€ LangGraph                      (multi-node orchestration)             â”‚
â”‚  â”œâ”€ TypedDict                      (state management)                     â”‚
â”‚  â””â”€ Conditional Edges              (intelligent routing)                  â”‚
â”‚                                                                             â”‚
â”‚  AI/ML Layer:                                                               â”‚
â”‚  â”œâ”€ LangChain                      (LLM framework)                        â”‚
â”‚  â”œâ”€ Google Gemini 2.0 Flash        (large language model)                â”‚
â”‚  â”œâ”€ GoogleGenerativeAI             (embeddings)                          â”‚
â”‚  â”œâ”€ RecursiveCharacterTextSplitter (text chunking)                       â”‚
â”‚  â””â”€ LCEL                           (chain composition)                    â”‚
â”‚                                                                             â”‚
â”‚  Database Layer:                                                            â”‚
â”‚  â”œâ”€ ChromaDB                       (vector database)                      â”‚
â”‚  â”œâ”€ Vector Embeddings              (semantic search)                      â”‚
â”‚  â”œâ”€ Persistence                    (./chroma_db/)                         â”‚
â”‚  â””â”€ Retriever                      (similarity search)                    â”‚
â”‚                                                                             â”‚
â”‚  Data Layer:                                                                â”‚
â”‚  â”œâ”€ data/product_info.txt          (source data)                         â”‚
â”‚  â”œâ”€ 2 text chunks                  (indexed content)                      â”‚
â”‚  â””â”€ Vector embeddings              (semantic representation)              â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Message Flow Example

```
User: "What is the battery life of power bank?"

Step 1: UI sends POST /chat
â”œâ”€ Query: "What is the battery life of power bank?"
â””â”€ Sends as JSON: {"query": "..."}

Step 2: FastAPI receives & validates
â”œâ”€ Pydantic validates ChatRequest
â”œâ”€ Query string extracted
â””â”€ Calls process_query(query)

Step 3: LangGraph classifier_node
â”œâ”€ Gemini analyzes: "battery", "life", "power bank"
â”œâ”€ Classification: "product"
â””â”€ Updates state: category = "product"

Step 4: Conditional router
â”œâ”€ Checks: category == "product"? YES
â”œâ”€ Routes to: RAG Responder Node
â””â”€ Passes state forward

Step 5: RAG Responder Node
â”œâ”€ Loads ChromaDB retriever
â”œâ”€ Searches for: "battery life power bank"
â”œâ”€ Finds CHUNK 2 match (relevance: 0.87)
â”œâ”€ Extracts: "10,000mAh battery with 12+ hours backup"
â”œâ”€ Creates prompt: "Answer only using provided context"
â”œâ”€ Calls Gemini with context
â”œâ”€ Gemini responds: "I don't have specific battery life..."
â””â”€ Returns response

Step 6: Response sent back to UI
â”œâ”€ JSON: {
â”‚    "query": "What is the battery life of power bank?",
â”‚    "response": "I don't have this information."
â”‚  }
â””â”€ UI displays with ğŸ›ï¸ Product badge

Step 7: Frontend renders
â”œâ”€ Shows user query
â”œâ”€ Shows bot response
â”œâ”€ Adds category badge
â””â”€ User sees complete answer
```

---

## ğŸ¯ System Strengths

âœ… **Modular Design:** Each component is independent  
âœ… **Scalable:** Easy to add more products/categories  
âœ… **RAG-powered:** Responses backed by real data  
âœ… **Intelligent Routing:** Context-aware classification  
âœ… **Professional UI:** Beautiful and responsive  
âœ… **Production Ready:** Error handling, validation  
âœ… **Fast:** Sub-second routing, 1-3s LLM calls  
âœ… **Persistent:** ChromaDB stores embeddings  

---

**System Architecture by LangChain + LangGraph + FastAPI + Gemini AI**
